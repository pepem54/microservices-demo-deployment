
name: Execute e2e tests
on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
  workflow_dispatch:

env:
  INTEGRATION_LAB_ID: "integ_master_813e_SLBoutique"
  BUILD_ID : build-${{ github.run_id }}-${{ github.run_attempt }}  
  
jobs:
  trigger_e2e_tests:
    runs-on: ubuntu-latest
    steps:
      - name: Set up QEMU
        uses: docker/setup-qemu-action@v1

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v1
        
          
      - name: API TEST
        uses: fjogeleit/http-request-action@v1
        with:
          url: 'https://dev-risk-management.dev.sealights.co/sl-api/v1/agent-apis/lab-ids/integ_master_813e_SLBoutique/integration-build'
          method: 'POST'    
          customHeaders: '{"Content-Type": "application/json", "Authorization": "Bearer ${{ secrets.BEARER }}"}'          
          data: '{"buildName": "$BUILD_ID"}'        
      
